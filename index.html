<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Emoji Sudoku Challenge</title>
    <meta property="og:title" content="Joue √† mon Emoji Sudoku !">
    <meta property="og:description" content="Peux-tu r√©soudre ce puzzle ? 3 niveaux de difficult√© avec des symboles funs !">
    <meta property="og:image" content="https://cheztotof.github.io/sudoku/burger_frites-removebg-preview-removebg-preview.png">
    <meta property="og:url" content="https://cheztotof.github.io/sudoku/">
    <meta property="og:type" content="website"> 
    
    <style>
        /* --- THEME FUTURISTE N√âON --- */
        :root { 
            --primary-neon-blue: #00e0ff; /* Bleu √©lectrique */
            --secondary-neon-magenta: #e000ff; /* Magenta vif */
            --neon-green: #39ff14; /* Vert citron n√©on */
            --danger: #ff0077; /* Rose n√©on pour les erreurs */
            --text-light: #e0e0e0; /* Texte clair pour fond sombre */
            --text-dark: #222222; /* Texte sombre (si n√©cessaire) */
            --background-dark: #1a1a1d; /* Fond presque noir */
            --grid-border-neon: #00e0ff; /* Bordure ext√©rieure de grille n√©on */
            --subgrid-border-neon: #e000ff; /* Bordures 3x3 de grille n√©on */
            --cell-gap-neon: #333333; /* Lignes fines entre cellules (gris fonc√©) */
            --button-glow: 0 0 8px rgba(0, 224, 255, 0.6), 0 0 16px rgba(0, 224, 255, 0.4);
            --button-glow-hover: 0 0 10px rgba(0, 224, 255, 0.8), 0 0 20px rgba(0, 224, 255, 0.6);
        }
        
        body { 
            font-family: 'Segoe UI', Roboto, sans-serif; 
            background: var(--background-dark); /* Fond sombre */
            color: var(--text-light); /* Texte clair */
            display: flex; flex-direction: column; align-items: center; 
            margin: 0; padding: 10px; min-height: 100vh;
        }
        
        h1 { 
            margin: 10px 0; font-size: 2.5rem; 
            color: var(--primary-neon-blue); /* Titre n√©on */
            text-shadow: 0 0 10px var(--primary-neon-blue), 0 0 20px var(--primary-neon-blue); /* Effet de lueur */
            letter-spacing: 2px;
        }
        p { font-size: 1.1rem; color: var(--text-light); }

        /* Conteneurs pour le th√®me n√©on */
        .container-box {
            background: rgba(30, 30, 35, 0.8); /* Fond sombre semi-transparent */
            padding: 25px;
            border-radius: 15px;
            backdrop-filter: blur(5px);
            box-shadow: 0 0 15px rgba(0, 224, 255, 0.3); /* Lueur n√©on l√©g√®re */
            text-align: center;
            border: 1px solid var(--primary-neon-blue); /* Bordure fine n√©on */
        }

        /* Menu Start */
        #start-screen { display: flex; flex-direction: column; gap: 15px; margin-top: 50px; }
        .btn { 
            padding: 12px 24px; font-size: 1.2rem; border: none; border-radius: 8px; 
            cursor: pointer; color: var(--text-light); transition: transform 0.2s, box-shadow 0.2s; 
            font-weight: bold; text-shadow: 0 0 5px rgba(255,255,255,0.7); 
            background: rgba(0, 224, 255, 0.2); /* Fond semi-transparent n√©on */
            border: 2px solid var(--primary-neon-blue); /* Bordure n√©on */
            box-shadow: var(--button-glow);
        }
        .btn:active { transform: scale(0.95); box-shadow: none; }
        .btn:hover { box-shadow: var(--button-glow-hover); filter: brightness(1.2); }
        
        /* Bouton Continuer (Sp√©cial) */
        #btn-continue { 
            background: linear-gradient(45deg, #00e0ff, #e000ff); /* D√©grad√© n√©on */
            border: 2px solid var(--neon-green); 
            display: none; /* Cach√© par d√©faut */
            animation: pulse-neon 2s infinite;
            box-shadow: 0 0 10px var(--neon-green), 0 0 20px var(--neon-green), 0 0 30px var(--neon-green);
        }

        .btn-easy { 
            background: linear-gradient(45deg, #00e0ff, #00ffc4); 
            border: 2px solid #00ffc4;
            box-shadow: 0 0 8px rgba(0,255,196,0.6);
        }
        .btn-medium { 
            background: linear-gradient(45deg, #e000ff, #ff00ea); 
            border: 2px solid #ff00ea;
            box-shadow: 0 0 8px rgba(255,0,234,0.6);
        }
        .btn-hard { 
            background: linear-gradient(45deg, #ff0077, #ff00ea); 
            border: 2px solid #ff0077;
            box-shadow: 0 0 8px rgba(255,0,119,0.6);
        }
        .btn-action { 
            background: rgba(0, 224, 255, 0.2); 
            border: 1px solid var(--primary-neon-blue); 
            color: var(--primary-neon-blue); /* Texte bouton action en n√©on */
            font-size: 1rem; padding: 10px 16px; margin: 5px; 
            box-shadow: 0 0 5px rgba(0, 224, 255, 0.5);
        }
        .btn-action:hover {
            box-shadow: 0 0 10px rgba(0, 224, 255, 0.8);
            filter: brightness(1.2);
        }
        
        @keyframes pulse-neon {
            0% { transform: scale(1); box-shadow: 0 0 10px var(--neon-green), 0 0 20px var(--neon-green), 0 0 30px var(--neon-green); }
            50% { transform: scale(1.05); box-shadow: 0 0 15px var(--neon-green), 0 0 25px var(--neon-green), 0 0 40px var(--neon-green); }
            100% { transform: scale(1); box-shadow: 0 0 10px var(--neon-green), 0 0 20px var(--neon-green), 0 0 30px var(--neon-green); }
        }

        /* Game Board */
        #game-screen { 
            display: none; flex-direction: column; align-items: center; width: 100%; max-width: 500px; margin-top: 20px;
            /* üçîüçü FOND D'√âCRAN BURGER/FRITES (conserve l'image) üçüüçî */
            background: url('burger_frites-removebg-preview-removebg-preview.png') no-repeat center bottom; 
            background-size: 100% auto; 
            min-height: 80vh; 
            border-radius: 15px; 
            padding: 20px;
            box-shadow: 0 0 20px rgba(0, 224, 255, 0.4); /* Lueur autour de l'√©cran de jeu */
        }

        /* üí° NOUVEAU STYLE: FOND SEMI-TRANSPARENT pour la lisibilit√© sur l'image */
        #game-content-overlay {
            background: rgba(10, 10, 15, 0.85); /* Fond tr√®s sombre opaque √† 85% */
            border-radius: 10px;
            padding: 10px;
            width: 100%;
            box-shadow: 0 0 10px rgba(0, 224, 255, 0.3);
            border: 1px solid var(--primary-neon-blue);
        }

        .stats { 
            display: flex; justify-content: space-between; width: 100%; margin-bottom: 10px; 
            font-weight: bold; text-shadow: 0 0 5px var(--primary-neon-blue); 
            padding: 0 10px; color: var(--text-light);
            font-size: 1.2rem;
        }
        
        #board { 
            display: grid; grid-template-columns: repeat(9, 1fr); 
            gap: 1px; background: var(--cell-gap-neon); /* Lignes fines entre cellules */
            border: 3px solid var(--grid-border-neon); /* Bordure ext√©rieure n√©on */
            width: 100%; aspect-ratio: 1; margin-bottom: 20px;
            border-radius: 8px; overflow: hidden;
            box-shadow: 0 0 15px var(--primary-neon-blue), 0 0 25px rgba(0, 224, 255, 0.3); /* Lueur de la grille */
        }
        
        .cell { 
            background: #2a2a2e; /* Fond des cellules en gris tr√®s fonc√© */
            color: var(--text-light); /* Texte des emojis en clair */
            display: flex; align-items: center; justify-content: center; 
            font-size: 1.8rem; cursor: pointer; user-select: none;
            transition: background 0.2s, box-shadow 0.2s;
        }
        
        .cell.selected { 
            background: #3a3a40 !important; /* Fond s√©lectionn√© l√©g√®rement plus clair */
            box-shadow: 0 0 10px var(--secondary-neon-magenta), inset 0 0 5px var(--secondary-neon-magenta); /* Lueur s√©lectionn√©e */
        } 
        
        .cell.fixed { 
            background: #1e1e22; /* Fond des cellules fixes encore plus fonc√© */
            color: #888888; /* Texte des emojis fixes en gris */
            cursor: default; 
        }
        
        .cell.error { 
            background: rgba(255, 0, 119, 0.6) !important; /* Rose n√©on pour les erreurs */
            box-shadow: 0 0 10px var(--danger), inset 0 0 5px var(--danger);
        }
        
        /* Bordures de sous-grille n√©on */
        .cell:nth-child(3n) { border-right: 3px solid var(--subgrid-border-neon); }
        .cell:nth-child(9n) { border-right: none; }
        .cell:nth-child(n+19):nth-child(-n+27), 
        .cell:nth-child(n+46):nth-child(-n+54) { border-bottom: 3px solid var(--subgrid-border-neon); }

        /* --- Animation de Victoire N√âON --- */
        @keyframes victory-shake {
            0% { transform: translate(1px, 1px) rotate(0deg); }
            25% { transform: translate(-1px, -2px) rotate(-0.5deg); }
            50% { transform: translate(1px, -1px) rotate(0.5deg); }
            75% { transform: translate(-1px, 2px) rotate(-0.5deg); }
            100% { transform: translate(1px, 1px) rotate(0deg); }
        }

        @keyframes victory-glow {
            0%, 100% { box-shadow: 0 0 20px var(--neon-green), 0 0 30px var(--neon-green); }
            50% { box-shadow: 0 0 30px var(--neon-green), 0 0 50px var(--neon-green), 0 0 70px rgba(57, 255, 20, 0.5); }
        }

        .victory-animation {
            animation: victory-shake 0.2s ease-in-out 3, victory-glow 0.8s infinite alternate;
            border-color: var(--neon-green) !important;
        }

        /* Controls */
        #keypad { 
            display: grid; grid-template-columns: repeat(5, 1fr); gap: 8px; width: 100%; 
            padding: 10px; background: rgba(0,0,0,0.3); border-radius: 12px; 
            border: 1px solid var(--secondary-neon-magenta);
            box-shadow: 0 0 10px rgba(224, 0, 255, 0.3);
        }
        .key { 
            background: rgba(224, 0, 255, 0.1); border: 1px solid var(--secondary-neon-magenta); 
            color: var(--secondary-neon-magenta); /* Couleurs des touches en magenta */
            border-radius: 8px; font-size: 1.8rem; padding: 10px 0; cursor: pointer; text-align: center; 
            transition: background 0.2s, box-shadow 0.2s;
            box-shadow: 0 0 5px rgba(224, 0, 255, 0.4);
        }
        .key:hover { 
            background: rgba(224, 0, 255, 0.2); 
            box-shadow: 0 0 10px rgba(224, 0, 255, 0.7);
        }
        .key:active { background: var(--secondary-neon-magenta); color: var(--text-dark); box-shadow: none;}
        
        .key.completed {
            opacity: 0.3;
            background: #333333;
            color: #666666;
            cursor: default;
            pointer-events: none;
            border-color: #555555;
            box-shadow: none;
        }
        
        #controls { margin-top: 15px; display: flex; gap: 10px; justify-content: center; flex-wrap: wrap; width: 100%; }
        
        /* Modal */
        #modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.95); align-items: center; justify-content: center; z-index: 100; }
        .modal-content { 
            background: var(--background-dark); 
            color: var(--text-light);
            border: 1px solid var(--primary-neon-blue); 
            box-shadow: 0 0 20px var(--primary-neon-blue);
        }
        .modal-content h2 { color: var(--neon-green); text-shadow: 0 0 10px var(--neon-green); }
        .modal-content p { color: var(--text-light); }
        
        .fb-btn { 
            margin-top:20px; 
            background: #1877F2; 
            width: 100%; font-weight: bold; 
            display: flex; align-items: center; justify-content: center; gap: 10px;
            border: 2px solid #00e0ff; /* Bordure n√©on pour bouton FB */
            box-shadow: 0 0 10px rgba(0, 224, 255, 0.5);
        }
        .fb-btn:hover {
            box-shadow: 0 0 15px rgba(0, 224, 255, 0.8);
        }

        /* Style des boutons de la modale */
        .modal-actions {
            display: flex;
            justify-content: space-around;
            gap: 15px;
            margin-top: 20px;
        }
        .modal-actions .btn {
            flex-grow: 1;
        }
        .modal-actions .btn:first-child { /* Bouton Rejouer */
            background: linear-gradient(45deg, #00e0ff, #00ffc4);
            border-color: #00ffc4;
            box-shadow: 0 0 8px rgba(0,255,196,0.6);
        }
        .modal-actions .btn:last-child { /* Bouton Accueil */
            background: linear-gradient(45deg, #e000ff, #ff00ea);
            border-color: #ff00ea;
            box-shadow: 0 0 8px rgba(255,0,234,0.6);
        }
    </style>
</head>
<body>

    <div id="start-screen" class="container-box">
        <h1>Emoji Sudoku üß©</h1>
        
        <button id="btn-continue" class="btn" onclick="continueGame()">‚ñ∂ Continuer la partie</button>
        
        <p style="color:#666">Choisis ton niveau pour commencer :</p>
        <button class="btn btn-easy" onclick="startGame('easy')">Facile (D√©butant)</button>
        <button class="btn btn-medium" onclick="startGame('medium')">Moyen (Habitu√©)</button>
        <button class="btn btn-hard" onclick="startGame('hard')">Difficile (Expert)</button>
    </div>

    <div id="game-screen">
        <div id="game-content-overlay"> 
            <div class="stats">
                <span id="mistakes">Erreurs: 0/3</span>
                <span id="hints">Indice: 0/3</span>
            </div>
            
            <div id="board"></div>

            <div id="keypad">
                </div>

            <div id="controls">
                <button class="btn btn-action" onclick="useHint()" id="btn-hint">Indice üí°</button>
                <button class="btn btn-action" onclick="goToStartScreen()">Accueil üè†</button>
            </div>
            <button class="btn btn-action fb-btn" onclick="shareOnFacebook()">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="white"><path d="M12 0c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm3 8h-1.35c-.538 0-.65.221-.65.778v1.222h2l-.209 2h-1.791v7h-3v-7h-2v-2h2v-2.308c0-1.769.931-2.692 3.029-2.692h1.971v3z"/></svg>
                Partager sur Facebook
            </button>
        </div> </div>

    <div id="modal">
        <div class="modal-content container-box">
            <h2 id="modal-title" style="font-size: 2rem; margin-bottom: 10px;"></h2>
            <p id="modal-msg" style="font-size: 1.2rem; margin-bottom: 25px;"></p>
            <div class="modal-actions">
                <button class="btn btn-action" style="background: #4caf50; font-size: 1.2rem; padding: 15px 30px;" onclick="restartGame()">Rejouer</button>
                <button class="btn btn-action" style="background: #03a9f4; font-size: 1.2rem; padding: 15px 30px;" onclick="goToStartScreen()">Accueil üè†</button>
            </div>
        </div>
    </div>

<script>
    // --- Configuration & Variables ---
    const emojis = ['üëç', 'üí•', 'ü§°', 'üî•', '‚ô•Ô∏è', 'üòà', 'üéâ', 'üåÄ', 'üåç'];
    let solution = [];
    let initialBoard = [];
    let currentBoard = [];
    let mistakes = 0;
    const maxMistakes = 3;
    let hintsUsed = 0;
    const maxHints = 3; 
    let selectedCellIndex = -1;
    let gameOver = false;
    const SAVE_KEY = 'emojiSudokuSave';

    // --- V√©rification de sauvegarde au d√©marrage ---
    window.onload = function() {
        if (localStorage.getItem(SAVE_KEY)) {
            document.getElementById('btn-continue').style.display = 'block';
        }
    };

    // --- Logique Sudoku (G√©n√©ration) ---
    function isValid(board, row, col, num) {
        for (let x = 0; x < 9; x++) if (board[row][x] === num || board[x][col] === num) return false;
        const startRow = row - row % 3, startCol = col - col % 3;
        for (let i = 0; i < 3; i++)
            for (let j = 0; j < 3; j++)
                if (board[i + startRow][j + startCol] === num) return false;
        return true;
    }

    function solveSudoku(board) {
        for (let i = 0; i < 9; i++) {
            for (let j = 0; j < 9; j++) {
                if (board[i][j] === 0) {
                    let nums = [1,2,3,4,5,6,7,8,9].sort(() => Math.random() - 0.5);
                    for (let num of nums) {
                        if (isValid(board, i, j, num)) {
                            board[i][j] = num;
                            if (solveSudoku(board)) return true;
                            board[i][j] = 0;
                        }
                    }
                    return false;
                }
            }
        }
        return true;
    }

    function generateBoard(difficulty) {
        let board = Array.from({ length: 9 }, () => Array(9).fill(0));
        solveSudoku(board);
        solution = board.map(row => [...row]); 

        let holes;
        switch(difficulty) {
            case 'easy': holes = 30; break;
            case 'medium': holes = 45; break;
            case 'hard': holes = 58; break; 
            default: holes = 30;
        }

        while (holes > 0) {
            let row = Math.floor(Math.random() * 9);
            let col = Math.floor(Math.random() * 9);
            if (board[row][col] !== 0) {
                board[row][col] = 0;
                holes--;
            }
        }
        return board;
    }

    // --- Fonctions de Sauvegarde ---
    function saveGame() {
        const gameState = {
            solution: solution,
            initialBoard: initialBoard,
            currentBoard: currentBoard,
            mistakes: mistakes,
            hintsUsed: hintsUsed
        };
        localStorage.setItem(SAVE_KEY, JSON.stringify(gameState));
        // Affiche le bouton continuer si on revient au menu
        document.getElementById('btn-continue').style.display = 'block';
    }

    function continueGame() {
        const savedData = localStorage.getItem(SAVE_KEY);
        if (!savedData) return;

        const state = JSON.parse(savedData);
        solution = state.solution;
        initialBoard = state.initialBoard;
        currentBoard = state.currentBoard;
        mistakes = state.mistakes;
        hintsUsed = state.hintsUsed;
        
        gameOver = false;
        selectedCellIndex = -1;

        // Lancer l'interface
        document.getElementById('start-screen').style.display = 'none';
        document.getElementById('game-screen').style.display = 'flex';
        document.getElementById('modal').style.display = 'none';
        
        updateStatsUI();
        renderBoard();
        renderKeypad();
        updateKeypadStatus();
    }

    // --- Interface & Moteur de Jeu ---
    function startGame(diff) {
        // Efface l'ancienne sauvegarde si on commence une nouvelle partie
        localStorage.removeItem(SAVE_KEY);
        document.getElementById('btn-continue').style.display = 'none';

        document.getElementById('start-screen').style.display = 'none';
        document.getElementById('game-screen').style.display = 'flex';
        
        mistakes = 0;
        hintsUsed = 0;
        gameOver = false;
        selectedCellIndex = -1;
        updateStatsUI();

        let matrix = generateBoard(diff);
        initialBoard = matrix.flat(); 
        solution = solution.flat();
        currentBoard = [...initialBoard];
        
        renderBoard();
        renderKeypad();
        updateKeypadStatus();
        saveGame(); // Sauvegarde initiale
    }
    
    function restartGame() {
         location.reload();
    }

    function goToStartScreen() {
        gameOver = false;
        selectedCellIndex = -1;
        document.getElementById('game-screen').style.display = 'none';
        document.getElementById('start-screen').style.display = 'flex';
        document.getElementById('modal').style.display = 'none';
        
        // V√©rifie s'il y a une sauvegarde pour afficher le bouton
        if (localStorage.getItem(SAVE_KEY)) {
            document.getElementById('btn-continue').style.display = 'block';
        }
    }

    function updateStatsUI() {
        document.getElementById('mistakes').textContent = `Erreurs: ${mistakes}/${maxMistakes}`;
        document.getElementById('hints').textContent = `Indice: ${hintsUsed}/${maxHints}`;
        document.getElementById('btn-hint').style.opacity = hintsUsed >= maxHints ? "0.5" : "1";
    }

    function renderBoard() {
        const boardDiv = document.getElementById('board');
        boardDiv.innerHTML = '';
        currentBoard.forEach((val, idx) => {
            let div = document.createElement('div');
            div.className = 'cell';
            div.id = `cell-${idx}`;
            
            if (initialBoard[idx] !== 0) {
                div.classList.add('fixed');
                div.textContent = emojis[val - 1];
            } else if (val !== 0) {
                div.textContent = emojis[val - 1];
            }
            
            div.onclick = () => selectCell(idx);
            boardDiv.appendChild(div);
        });
    }

    function renderKeypad() {
        const kp = document.getElementById('keypad');
        kp.innerHTML = ''; 
        emojis.forEach((emoji, idx) => {
            let btn = document.createElement('div');
            btn.className = 'key';
            btn.id = `key-${idx+1}`;
            btn.textContent = emoji;
            btn.onclick = (e) => { e.stopPropagation(); inputNumber(idx + 1); };
            kp.appendChild(btn);
        });
    }

    function updateKeypadStatus() {
        let counts = Array(10).fill(0);
        currentBoard.forEach(val => {
            if (val !== 0) counts[val]++;
        });

        for (let i = 1; i <= 9; i++) {
            const btn = document.getElementById(`key-${i}`);
            if (btn) {
                if (counts[i] === 9) {
                    btn.classList.add('completed');
                } else {
                    btn.classList.remove('completed');
                }
            }
        }
    }

    function selectCell(idx) {
        if (gameOver) return;
        // La cellule fixe (initialBoard[idx] !== 0) ne peut pas √™tre s√©lectionn√©e pour la modification
        if (initialBoard[idx] !== 0) {
            if (selectedCellIndex !== -1) document.getElementById(`cell-${selectedCellIndex}`).classList.remove('selected');
            selectedCellIndex = -1; // Ne rien s√©lectionner
            return;
        }

        if (selectedCellIndex !== -1) document.getElementById(`cell-${selectedCellIndex}`).classList.remove('selected');
        selectedCellIndex = idx;
        document.getElementById(`cell-${idx}`).classList.add('selected');
    }

    function inputNumber(num) {
        if (gameOver || selectedCellIndex === -1 || initialBoard[selectedCellIndex] !== 0) return;

        let cell = document.getElementById(`cell-${selectedCellIndex}`);
        let correctVal = solution[selectedCellIndex];

        if (num !== correctVal) {
            mistakes++;
            updateStatsUI();
            saveGame(); 

            // LOGIQUE d'erreur : Affiche l'emoji Vertige
            const previousContent = cell.textContent;
            cell.textContent = 'üòµ‚Äçüí´'; // Emoji Vertige
            cell.classList.add('error');
            
            setTimeout(() => {
                if (!gameOver) {
                    cell.classList.remove('error');
                    // R√©affiche l'ancien contenu (s'il y en avait)
                    cell.textContent = currentBoard[selectedCellIndex] !== 0 
                                       ? emojis[currentBoard[selectedCellIndex] - 1] 
                                       : '';
                }
            }, 800);
            
            if (mistakes >= maxMistakes) endGame(false);
        } else {
            currentBoard[selectedCellIndex] = num;
            cell.textContent = emojis[num - 1];
            cell.classList.remove('selected');
            selectedCellIndex = -1;
            
            updateKeypadStatus();
            saveGame(); // Sauvegarde le coup
            checkWin();
        }
    }

    function useHint() {
        if (gameOver || hintsUsed >= maxHints) return;
        
        let targetIdx = selectedCellIndex;
        if (targetIdx === -1 || currentBoard[targetIdx] !== 0) {
           let emptyIndices = currentBoard.map((val, idx) => val === 0 ? idx : null).filter(val => val !== null);
           if (emptyIndices.length === 0) return;
           targetIdx = emptyIndices[Math.floor(Math.random() * emptyIndices.length)];
           selectCell(targetIdx);
        }

        hintsUsed++;
        let correctVal = solution[targetIdx];
        currentBoard[targetIdx] = correctVal;
        let cell = document.getElementById(`cell-${targetIdx}`);
        cell.textContent = emojis[correctVal - 1];
        
        cell.style.transition = "all 0.3s";
        cell.style.transform = "scale(1.2)";
        cell.style.background = "rgba(0, 224, 255, 0.3)"; // Utilisation de la couleur n√©on pour l'indice
        setTimeout(() => {
             cell.style.transform = "scale(1)";
             cell.style.background = "";
        }, 300);

        updateStatsUI();
        updateKeypadStatus();
        saveGame(); // Sauvegarde l'indice
        checkWin();
    }

    function checkWin() {
        if (!currentBoard.includes(0)) endGame(true);
    }

    function endGame(win) {
        gameOver = true;
        // Supprime la sauvegarde car la partie est finie
        localStorage.removeItem(SAVE_KEY);
        document.getElementById('btn-continue').style.display = 'none';

        const modal = document.getElementById('modal');
        const title = document.getElementById('modal-title');
        const msg = document.getElementById('modal-msg');
        
        // --- G√©rer l'animation de victoire ---
        if (win) {
            const boardDiv = document.getElementById('board');
            boardDiv.classList.add('victory-animation'); // Ajout de la classe d'animation
            
            // Retirer l'animation apr√®s un court d√©lai pour que la grille soit normale sur la modale
            setTimeout(() => {
                boardDiv.classList.remove('victory-animation');
            }, 1500); // 1.5 seconde d'animation
        }
        // --- FIN GESTION ANIMATION ---

        setTimeout(() => {
            modal.style.display = 'flex';
            if (win) {
                title.innerHTML = "üéâ Victoire ! üéâ";
                msg.textContent = "Bravo, tu as r√©solu le Emoji Sudoku !";
            } else {
                title.innerHTML = "‚ò†Ô∏è Game Over ‚ò†Ô∏è";
                msg.textContent = "Tu as fait 3 erreurs. Retente ta chance !";
            }
        }, 500);
    }

    function shareOnFacebook() {
        const url = encodeURIComponent(window.location.href); 
        const shareUrl = `https://www.facebook.com/sharer/sharer.php?u=${url}`;
        window.open(shareUrl, '_blank'); 
        return false;
    }
</script>
</body>
</html>
